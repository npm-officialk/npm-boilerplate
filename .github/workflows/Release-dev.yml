name: "ğŸ—ï¸ğŸ“¡ Deploy to development"
run-name: ${{ github.workflow }}-${{ github.ref_name }}

on:
    push:
        branches:
            - development

concurrency:
    group: ${{ github.workflow }}-${{ github.ref_name }}
    cancel-in-progress: true

jobs:
    # setup the project and needed tools
    setup:
        name: "âš™ï¸ setup project"
        uses: ./.github/workflows/uniflow-setup.yml

    # check static code quality and formatting
    QA:
        needs: [setup]
        name: "ğŸ¨ check code quality"
        uses: ./.github/workflows/uniflow-qa.yml

    # check tests and coverage of code
    tests:
        needs: [QA]
        name: "ğŸ§ª test code coverage"
        uses: ./.github/workflows/uniflow-test.yml

    # audit packages, library and code vunerabilites
    audit:
        needs: [tests]
        name: "ğŸ” audit vunerabilities"
        uses: ./.github/workflows/uniflow-audit.yml
        secrets:
            SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}

    # build output files and folders
    build:
        needs: [audit]
        name: "ğŸ“¦ build outputs"
        uses: ./.github/workflows/uniflow-build.yml

    # build output files and folders
    deploy:
        needs: [build]
        name: "ğŸ¯ release outputs"
        uses: ./.github/workflows/uniflow-deploy.yml
        with:
            env: development
